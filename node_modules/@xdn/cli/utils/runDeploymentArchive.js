"use strict";

const {
  join
} = require('path');

const unzip = require('./unzip');

const {
  emptyDirSync
} = require('fs-extra');

const runWithServerless = require('./runWithServerless');
/**
 * Use this function to run a deployment bundle (zip file) downloaded from moovweb.app.
 * @param filePath The path to the deployment bundle
 */


module.exports = async function runDeploymentArchive(filePath) {
  const dest = join(process.cwd(), filePath).replace('.zip', '');
  const xdnDir = join(dest, '.xdn');
  emptyDirSync(dest);
  await unzip(filePath, xdnDir);
  await runWithServerless(xdnDir);
};